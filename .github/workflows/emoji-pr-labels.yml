# ðŸŽ¨ Emoji PR Labels - Add emoji labels to pull requests
name: ðŸ·ï¸ Emoji PR Labels

on:
  pull_request:
    types: [opened, synchronize]

jobs:
  label-pr:
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
    
    steps:
      - name: ðŸ“¥ Checkout
        uses: actions/checkout@v4

      - name: ðŸ·ï¸ Add emoji labels based on files
        uses: actions/github-script@v7
        with:
          script: |
            const { data: files } = await github.rest.pulls.listFiles({
              owner: context.repo.owner,
              repo: context.repo.repo,
              pull_number: context.issue.number
            });
            
            const labels = new Set();
            
            for (const file of files) {
              const ext = file.filename.split('.').pop();
              
              // Add labels based on file types
              if (['ts', 'tsx', 'js', 'jsx'].includes(ext)) labels.add('ðŸ’» code');
              if (['md', 'mdx', 'txt'].includes(ext)) labels.add('ðŸ“ docs');
              if (['css', 'scss', 'sass'].includes(ext)) labels.add('ðŸŽ¨ styles');
              if (['test', 'spec'].some(t => file.filename.includes(t))) labels.add('ðŸ§ª tests');
              if (['json', 'yml', 'yaml', 'toml'].includes(ext)) labels.add('âš™ï¸ config');
              if (file.filename.includes('.github')) labels.add('ðŸ”§ ci');
            }
            
            // Add size labels
            const totalChanges = files.reduce((sum, f) => sum + f.changes, 0);
            if (totalChanges < 10) labels.add('ðŸ”¹ tiny');
            else if (totalChanges < 50) labels.add('ðŸ”¸ small');
            else if (totalChanges < 200) labels.add('ðŸ”¶ medium');
            else labels.add('ðŸ”· large');
            
            if (labels.size > 0) {
              await github.rest.issues.addLabels({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: context.issue.number,
                labels: Array.from(labels)
              });
            }
