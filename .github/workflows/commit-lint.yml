# âœ… Commit Lint - Validate emoji conventions
# Checks all PR commits for proper emoji prefixes

name: âœ… Commit Lint

on:
  pull_request:
    types: [opened, synchronize]

jobs:
  lint:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: âœ… Lint Commits
        run: |
          echo "ğŸ” Checking commits for emoji conventions..."
          echo ""
          
          PASS=0
          FAIL=0
          
          for commit in $(git log origin/${{ github.base_ref }}..HEAD --format="%H"); do
            MSG=$(git log -1 --format="%s" $commit)
            HASH=$(git log -1 --format="%h" $commit)
            
            # Check if starts with emoji
            if echo "$MSG" | grep -qE "^[ğŸ‰âœ¨ğŸ›ğŸ”¥ğŸ“ğŸš€ğŸ’„â™»ï¸ğŸ”§âœ…ğŸ”’â¬†ï¸â¬‡ï¸ğŸ—ï¸ğŸ“¦ğŸ”€ğŸš§ğŸš‘âªğŸ’šğŸ‘·ğŸ“ŒğŸš¨â­ğŸŒŸğŸ’«ğŸŒ ğŸ”†ğŸ”…ğŸ› ï¸âš™ï¸ğŸ”©â›ï¸ğŸ”¨ğŸª›ğŸªšğŸ”—â›“ï¸ğŸ§°ğŸ”ŒğŸ’¡ğŸ”‹ğŸ’»ğŸ’ğŸ”·ğŸ”¶ğŸ’ ]"; then
              echo "âœ… $HASH $MSG"
              ((PASS++))
            else
              echo "âŒ $HASH $MSG"
              echo "   ğŸ’¡ Suggestion: Add an emoji prefix (e.g., âœ¨ for features, ğŸ› for bugs)"
              ((FAIL++))
            fi
          done
          
          echo ""
          echo "ğŸ“Š Results: $PASS passed, $FAIL failed"
          
          if [ $FAIL -gt 0 ]; then
            echo ""
            echo "âŒ Some commits are missing emoji prefixes!"
            echo "ğŸ“– See: https://gitmoji.dev for emoji guide"
            exit 1
          fi
          
          echo "âœ… All commits follow emoji conventions!"

